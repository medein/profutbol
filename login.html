<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acceso Usuarios - ProFutbol</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #f3f4f6;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .card {
            background: white;
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 400px;
        }
    </style>
</head>
<body>
    <div class="card">
        <h2 class="text-2xl font-bold text-green-700 mb-4">Acceso de Usuarios</h2>
        <p class="mb-6 text-gray-600">Ingresa tus credenciales para acceder al sistema de reservas.</p>

        <form id="loginAdminForm">
            <div id="message" class="mb-4 p-3 rounded text-sm hidden"></div>

            <div class="mb-4">
                <label for="loginEmail" class="block text-sm font-medium text-gray-700">Correo Electrónico</label>
                <input type="email" id="loginEmail" required class="mt-1 block w-full border border-gray-300 rounded-md p-2" placeholder="usuario@ejemplo.com">
            </div>

            <div class="mb-6">
                <label for="loginPassword" class="block text-sm font-medium text-gray-700">Contraseña</label>
                <input type="password" id="loginPassword" required class="mt-1 block w-full border border-gray-300 rounded-md p-2">
            </div>

            <button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded transition duration-200">
                Iniciar Sesión
            </button>
        </form>

        <p class="mt-4 text-center text-sm">
            ¿Aún no tienes cuenta? <a href="registro.html" class="text-green-600 hover:text-green-800 font-medium">Regístrate aquí.</a>
        </p>
    </div>

    <script type="module">
        // --- 1. IMPORTACIONES ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        // --- 2. CONFIGURACIÓN (IDÉNTICA a index.html) ---
        const firebaseConfig = {
            apiKey: "AIzaSyAWCPbrKbfVNieWdjIWOmsr27sqAWzEefk", 
            authDomain: "profutbolapp.firebaseapp.com",
            projectId: "profutbolapp",
            storageBucket: "profutbolapp.firebasestorage.app",
            messagingSenderId: "187277252854",
            appId: "1:187277252854:web:73d371c14b28f764de74d7"
        };
        
        // --- 3. INICIALIZACIÓN ---
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        
        // Elementos del DOM
        const loginForm = document.getElementById('loginAdminForm');
        const emailInput = document.getElementById('loginEmail');
        const passwordInput = document.getElementById('loginPassword');
        const messageBox = document.getElementById('message');

        // --- 4. FUNCIÓN AUXILIAR PARA MENSAJES ---
        function showMessage(text, isError) {
            messageBox.textContent = text;
            messageBox.classList.remove('hidden', 'bg-red-100', 'text-red-700', 'bg-green-100', 'text-green-700');
            if (isError) {
                messageBox.classList.add('bg-red-100', 'text-red-700');
            } else {
                messageBox.classList.add('bg-green-100', 'text-green-700');
            }
        }

        // --- 5. LÓGICA DE LOGIN ---
        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();

            const email = emailInput.value;
            const password = passwordInput.value;
            
            showMessage("Iniciando sesión...", false);

            try {
                // Intenta iniciar sesión
                await signInWithEmailAndPassword(auth, email, password);
                
                // Si tiene éxito, redirige a index.html (La verificación de rol se hará allí)
                window.location.href = 'index.html';

            } catch (error) {
                console.error("Error al iniciar sesión:", error);
                let errorMessage = "Credenciales incorrectas. Intenta de nuevo.";
                
                if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
                    errorMessage = 'Correo o contraseña inválidos.';
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage = 'El formato del correo electrónico es inválido.';
                } else if (error.code === 'auth/too-many-requests') {
                    errorMessage = 'Acceso bloqueado temporalmente debido a demasiados intentos fallidos.';
                }
                
                showMessage(`Error: ${errorMessage}`, true);
            }
        });
    </script>
</body>
</html>